<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Untitled Scifi Western Pre-Adventure</title>
    <style>
        /* Center the canvas */
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        canvas {
            border: 1px solid #000;
        }
        
        /* Modal styling, positioned at the top center of the canvas */
        #modal, #opening-modal {
            display: none;
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            width: 400px; /* Increased width */
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
        }
        #modal p, #opening-modal p {
            margin: 0 0 20px;
            font-size: 18px; /* Larger font for readability */
        }
        .btn {
            background-color: #008cba;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px; /* Slightly larger button text */
            margin-left: 20px; /* Added space next to button */
        }
        .btn:hover {
            background-color: #005f5f;
        }

        /* Motivation bar styling */
        #motivation-bar {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 200px;
            height: 30px;
            background-color: #e0e0e0;
            border-radius: 5px;
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
        }
        #motivation-fill {
            height: 100%;
            width: 50%; /* Initial motivation at 5 points */
            background-color: #76c7c0;
            border-radius: 5px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
    <div id="motivation-bar">
        <div id="motivation-fill"></div>
    </div>

    <div id="opening-modal">
        <p id="opening-message">Welcome to the Untitled Scifi Western Pre-Adventure! Your goal is to interact with various elements, hopefully inspiring you to overcome design obstacles in the creation of your untitled scifi Western campaign setting. Be careful not to lose all motivation!</p>
        <button id="start-btn" class="btn">Start</button>
    </div>

    <div id="modal">
        <p id="modal-message">Message</p>
        <button id="increase-btn" class="btn">Increase Motivation</button>
        <button id="decrease-btn" class="btn">Decrease Motivation</button>
    </div>

    <script>
        let bg; // Variable to store the background image
        let motivation = 5; // Start motivation at 5
        let areas = [
            {x: 198, y: 543, w: 240, h: 320, message: "You clicked on Character 1!", visible: true},
            {x: 575, y: 425, w: 263, h: 448, message: "Character 2 says hi!", visible: true},
            {x: 949, y: 417, w: 141, h: 298, message: "Character 3 is intrigued.", visible: true},
            {x: 1106, y: 544, w: 125, h: 171, message: "Character 4 is mysterious.", visible: true},
            {x: 1253, y: 515, w: 164, h: 342, message: "Character 5 looks strong.", visible: true},
            {x: 635, y: 270, w: 220, h: 96, message: "This path leads somewhere unknown.", visible: true},
            {x: 445, y: 425, w: 125, h: 165, message: "Storefront 1 has goods for sale.", visible: true},
            {x: 1000, y: 95, w: 100, h: 250, message: "Storefront 2 is closed.", visible: true},
            {x: 500, y: 315, w: 130, h: 75, message: "Storefront 3 is welcoming you.", visible: true}
        ];
        let isModalOpen = false;

        function preload() {
            bg = loadImage('background.png'); // Load the background image
        }

        function setup() {
            createCanvas(1500, 900);

            // Show the opening modal on game start
            document.getElementById('opening-modal').style.display = 'flex';
            isModalOpen = true;

            // Start button closes the opening modal
            document.getElementById('start-btn').onclick = function() {
                document.getElementById('opening-modal').style.display = 'none';
                isModalOpen = false;
            };

            // Increase button for motivation
            document.getElementById('increase-btn').onclick = function() {
                updateMotivation(1);
                closeModal();
            };

            // Decrease button for motivation
            document.getElementById('decrease-btn').onclick = function() {
                updateMotivation(-1);
                closeModal();
            };
        }

        function draw() {
            background(bg); // Display the background image

            // Display mouse coordinates at the top left corner
            fill(255); // White color for text
            textSize(16);
            text("X: " + mouseX + " Y: " + mouseY, 10, 20); // Display coordinates for testing

            // Draw motivation bar
            let motivationFill = document.getElementById('motivation-fill');
            motivationFill.style.width = (motivation * 10) + "%";

            // Draw transparent rectangles for interactive areas
            areas.forEach(area => {
                if (area.visible) drawRectangle(area, [255, 255, 255, 50]);
            });

            // Highlight rectangles on hover
            areas.forEach(area => {
                if (area.visible && isMouseOverRectangle(area)) drawRectangle(area, [255, 255, 255, 100]);
            });
        }

        function drawRectangle(area, color) {
            fill(...color);
            noStroke();
            rect(area.x, area.y, area.w, area.h);
        }

        function isMouseOverRectangle(area) {
            return mouseX > area.x && mouseX < area.x + area.w &&
                   mouseY > area.y && mouseY < area.y + area.h;
        }

        function mousePressed() {
            // Ignore clicks when a modal is open
            if (isModalOpen) return;

            // Check if any area is clicked
            areas.forEach(area => {
                if (area.visible && isMouseOverRectangle(area)) {
                    showMessage(area);
                    area.visible = false; // Make the area disappear after interaction
                }
            });
        }

        function showMessage(area) {
            document.getElementById('modal-message').innerText = area.message;
            document.getElementById('modal').style.display = 'flex';
            isModalOpen = true;
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            isModalOpen = false;
        }

        function updateMotivation(change) {
            motivation = Math.min(10, Math.max(0, motivation + change)); // Keep motivation within 0-10
        }
    </script>
</body>
</html>
