<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Untitled Scifi Western Pre-Adventure</title>
    <style>
        /* Center the canvas and its wrapper */
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        /* Canvas wrapper to position elements relative to the canvas */
        #canvas-wrapper {
            position: relative;
            display: inline-block;
        }

        canvas {
            border: 1px solid #000;
        }

        /* Modal styling, positioned at the top center of the canvas */
        .modal {
            display: none;
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            width: 400px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
        }

        .modal p {
            margin: 0 0 20px;
            font-size: 18px;
        }

        .btn {
            background-color: #008cba;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-left: 20px;
        }

        .btn:hover {
            background-color: #005f5f;
        }

        /* Motivation bar styling */
        #motivation-bar {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 200px;
            height: 30px;
            background-color: #e0e0e0;
            border-radius: 5px;
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            padding-left: 10px;
            font-size: 14px;
            color: #333;
            font-weight: bold;
        }

        #motivation-fill {
            height: 100%;
            background-color: #76c7c0;
            border-radius: 5px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
    <div id="canvas-wrapper">
        <canvas></canvas>
        <div id="motivation-bar">
            <span id="motivation-label">Motivation: 5/10</span>
            <div id="motivation-fill"></div>
        </div>
    </div>

    <script>
        let bg;
        let motivation = 5;
        let areas = [
            {x: 198, y: 543, w: 240, h: 320, message: "You clicked on Character 1!", visible: true},
            {x: 575, y: 425, w: 263, h: 448, message: "Character 2 says hi!", visible: true},
            {x: 949, y: 417, w: 141, h: 298, message: "Character 3 is intrigued.", visible: true},
            {x: 1106, y: 544, w: 125, h: 171, message: "Character 4 is mysterious.", visible: true},
            {x: 1253, y: 515, w: 164, h: 342, message: "Character 5 looks strong.", visible: true}
        ];
        let isModalOpen = false;

        function preload() {
            bg = loadImage('background.png');
        }

        function setup() {
            createCanvas(1500, 900).parent('canvas-wrapper');
        }

        function draw() {
            background(bg);
            updateMotivationDisplay();

            // Draw transparent rectangles for interactive areas
            areas.forEach(area => {
                if (area.visible) drawRectangle(area, [255, 255, 255, 50]);
            });

            // Highlight rectangles on hover
            areas.forEach(area => {
                if (area.visible && isMouseOverRectangle(area)) drawRectangle(area, [255, 255, 255, 100]);
            });
        }

        function drawRectangle(area, color) {
            fill(...color);
            noStroke();
            rect(area.x, area.y, area.w, area.h);
        }

        function isMouseOverRectangle(area) {
            return mouseX > area.x && mouseX < area.x + area.w &&
                   mouseY > area.y && mouseY < area.y + area.h;
        }

        function mousePressed() {
            if (isModalOpen) return;

            // Check if any area is clicked
            areas.forEach((area, index) => {
                if (area.visible && isMouseOverRectangle(area)) {
                    showMessage(area, index);
                    area.visible = false;
                }
            });
        }

        function showMessage(area, index) {
            isModalOpen = true;

            // Create a new modal dynamically
            const modal = document.createElement('div');
            modal.classList.add('modal');
            modal.innerHTML = `<p>${area.message}</p>`;

            // Create Increase and Decrease buttons in random order
            const buttonOrder = Math.random() > 0.5 ? ['increase', 'decrease'] : ['decrease', 'increase'];
            buttonOrder.forEach(action => {
                const btn = document.createElement('button');
                btn.classList.add('btn');
                btn.innerText = action === 'increase' ? 'Increase Motivation' : 'Decrease Motivation';
                btn.onclick = () => {
                    updateMotivation(action === 'increase' ? 1 : -1);
                    closeModal(modal);
                };
                modal.appendChild(btn);
            });

            document.body.appendChild(modal);
            modal.style.display = 'flex';
        }

        function closeModal(modal) {
            modal.style.display = 'none';
            isModalOpen = false;
            document.body.removeChild(modal);
        }

        function updateMotivation(change) {
            motivation = Math.min(10, Math.max(0, motivation + change));
            updateMotivationDisplay();
        }

        function updateMotivationDisplay() {
            document.getElementById('motivation-fill').style.width = (motivation * 10) + "%";
            document.getElementById('motivation-label').innerText = `Motivation: ${motivation}/10`;
        }
    </script>
</body>
</html>
